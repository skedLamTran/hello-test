"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getNextItemFocus = exports.getItems = exports.itemSelector = void 0;

require("core-js/modules/es.array.from.js");

require("core-js/modules/es.array.includes.js");

require("core-js/modules/es.string.includes.js");

var _getNextFocus = require("../../utils/getNextFocus");

const itemSelector = '[role="treeitem"]:not(:disabled),[role="listitem"]:not(:disabled),[role="menuitem"]:not(:disabled)';
exports.itemSelector = itemSelector;

const getItems = ref => Array.from(ref.querySelectorAll(itemSelector));

exports.getItems = getItems;

const getNextItemFocus = (direction, element, vertical) => {
  const items = getItems(element);

  if (items.length > 0) {
    const focusedElement = document.activeElement;
    const isItemFocused = focusedElement && items.includes(focusedElement);
    const closestWrapper = focusedElement === null || focusedElement === void 0 ? void 0 : focusedElement.closest('li:not(:disabled)');

    if (vertical) {
      const target = isItemFocused ? focusedElement : closestWrapper.querySelector(itemSelector);
      const next = items.findIndex(el => el === target) + direction;

      if (next === items.length || !items[next]) {
        return (0, _getNextFocus.getFallbackElement)(direction, element, items);
      }

      return items[next];
    } else if (vertical === false) {
      const tabStops = Array.from(closestWrapper.querySelectorAll('a,input,button:not(:disabled),[tabindex="0"],[tabindex="-1"]:not(:disabled)'));
      const next = tabStops.findIndex(el => el === focusedElement) + direction;

      if (next === tabStops.length || !tabStops[next]) {
        return (0, _getNextFocus.getFallbackElement)(direction, focusedElement, tabStops);
      }

      return tabStops[next];
    }
  }

  return (0, _getNextFocus.getFallbackElement)(direction, element, items);
};

exports.getNextItemFocus = getNextItemFocus;
//# sourceMappingURL=getNextItemFocus.js.map